// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
syntax = "proto3";

package azdext;

option go_package = "github.com/azure/azure-dev/cli/azd/pkg/azdext";

import "models.proto";

// ProjectService defines methods for managing projects and their configurations.
service ProjectService {
  // Gets the current project.
  rpc Get(EmptyRequest) returns (GetProjectResponse);

  // AddService adds a new service to the project.
  rpc AddService(AddServiceRequest) returns (EmptyResponse);

  // GetResolvedServices gets the resolved list of services after processing any importers (e.g., Aspire projects).
  // This returns the actual services that will be deployed, including those generated by importers.
  rpc GetResolvedServices(EmptyRequest) returns (GetResolvedServicesResponse);

  // ParseGitHubUrl parses a GitHub URL and extracts repository information.
  rpc ParseGitHubUrl(ParseGitHubUrlRequest) returns (ParseGitHubUrlResponse);
}

// GetProjectResponse message definition
message GetProjectResponse {
  ProjectConfig project = 1;
}

// AddServiceRequest message definition
message AddServiceRequest {
  ServiceConfig service = 1;
}

// GetResolvedServicesResponse message definition
message GetResolvedServicesResponse {
  // Map of service name to service configuration
  map<string, ServiceConfig> services = 1;
}

// ParseGitHubUrlRequest message definition
message ParseGitHubUrlRequest {
  string url = 1;
}

// ParseGitHubUrlResponse message definition
message ParseGitHubUrlResponse {
  string hostname = 1;
  string repo_slug = 2;
  string branch = 3;
  string file_path = 4;
}
